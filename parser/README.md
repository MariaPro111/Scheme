# scheme-parser

Это вторая часть [scheme](../../scheme). 

## Что сделано?

Написан парсер для языка scheme. Парсер принимает последовательность токенов и строит по ним *синтаксическое дерево* - некоторое внутреннее представление заданного выражения, структуру данных, которая будет передана вычисляющему алгоритму.
Синтаксическое дерево состоит из наследников класса `Object`.

## Синтаксис scheme

* В простом случае выражения языка состоят из одного числа, boolean-а или идентификатора. В этом случае дерево разбора состоит из одной вершины - числа или идентификатора. Для представления числа сделан отдельный класс, наследник `Object`. Для представления идентификатора тоже сделан отдельный класс.

```
5
+
foo-bar
```

* Выражение может быть парой. Пара обозначается круглыми скобками с точкой между двумя элементами. Для пары тоже создан отдельный класс. Например, для выражения `(1 .   строиться дерево из 3-х элементов. Корнем дерева является пара с двумя потомками.

* Выражение может быть списком. Список - это одна из двух сущностей:

    1. Пустой список. Обозначается пустыми скобочками - `()`. Можно думать, что это объект-константа со специальной
       семантикой.
    2. Пара, в которой второй элемент это список. В этом случае первый элемент пары называется головой (head) списка, а
       второй - хвостом (tail).

Из этого определения следует, что список из трех элементов можно записать так:

```
(1 . (2 . (3 . ())))

 pair => pair => pair => ()
  |       |       |
  1       2       3
```

Однако так записывать списки неудобно и разработчики языка добавили сокращенную запись:

```
(1 2 3)
```

Так записывается "правильный" список (proper list). Парсер по обоим представлениям списка строит **одинаковое** синтаксическое дерево.

В языке также есть поддержка "неправильных" списков (improper list). В таком списке второй элемент самой вложенной пары не является пустым списком.

```
(1 . (2 . 3))
pair => pair => 3
  |       |
  1       2
```

Для таких списков тоже есть сокращенная запись:

```
(1  2 . 3)
```

Элементы списков могут любыми корректными выражениями:

```
((1 . 2) (3 4) 5)
(1 () (2 3 4) 5)
```

* Пустой список представляется с помощью `nullptr`.

## Обработка ошибок

Парсер проверяет входной поток на корректность. В случае, если поток токенов не соответствует корректному выражению, выбрасывается исключение `SyntaxError`, определенное в `error.h`.

